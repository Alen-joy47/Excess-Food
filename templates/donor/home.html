{% extends 'base/indexBase.html' %}
{% load static %}
{% block content %}
{% block navbar %}
<div class="collapse navbar-collapse mx-5" id="navbarSupportedContent">
  <ul class="navbar-nav me-auto mb-2 mb-lg-0">
    <li class="nav-item">
    </li>
  </ul>
  <a href="/logoutNow/" class="mx-3"><button class="btn btn-danger text-white" type="button"><b>Logout</b></button></a>
</div>
{% endblock navbar %}

{% block floatingButton %}
<button onclick="addFood();">
  <div class="floating-container">
    <div class="floating-button">+</div>
  </div>
</button>
{% endblock floatingButton %}

<div class="container-fluid" style="margin-top: 80px;">
  {% include 'base/messages.html' %}
  <div class="card-group">
    <div class="row">
      {% for food in foods %}
      <div class="col-3">
        <div class="card my-3">
          <img src="{{ food.image.url }}" class="card-img-top" alt="..." height="250px">
          <div class="card-body">
            <div class="d-flex">
              <h5 class="card-title">{{ food.name }}</h5>
              {% if food.type == "Pure Veg" %}
              <p class="text-white bg-success rounded text-center w-25 ml-auto p-0 text-nowrap">{{ food.type }}</p>
              {% else %}
              <p class="text-white bg-danger rounded text-center w-25 ml-auto p-0 text-nowrap">{{ food.type }}</p>
              {% endif %}
            </div>
            <div class="description-container">
              <p class="card-text description">{{ food.description|truncatewords:30 }}</p>
              {% if food.description|wordcount > 30 %}
              <p class="read-more"><a href="#" class="toggle-description">Read More</a></p>
              <p class="full-description">{{ food.description }}</p>
              {% endif %}
            </div>
            <div class="text-center my-3"><a href="/getFood/{{food.id}}/0"><button
                  class="btn btn-success text-center">Get Food</button></a></div>
            <p class="card-text"><small class="text-muted">{{ food.created_date }}</small></p>
          </div>
        </div>
      </div>
      {% endfor %}
    </div>
  </div>
</div>
</div>

<!-- Modal -->
<div class="modal fade" id="addFoodModal" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel"
  aria-hidden="true">
  <div class="modal-dialog" role="document">
    <div class="modal-content">
      <form action="/addFood/1" method="post" enctype="multipart/form-data">
        {% csrf_token %}
        <div class="modal-header">
          <h5 class="modal-title text-primary" id="heading">Add Food</h5>
          <button type="button" class="close" data-bs-dismiss="modal" aria-bs-label="Close">
            <span aria-hidden="true">&times;</span>
          </button>
        </div>
        <div class="modal-body">

          <!-- Input Text Field -->
          <div class="form-group">
            <label for="textInput">Food Name</label>
            <input type="text" class="form-control" id="name" name="name" placeholder="Enter name" required>
          </div>

          <!-- Select Field -->
          <div class="form-group">
            <label for="selectField">Food Type</label>
            <select class="form-control" id="type" name="type">
              <option value="-1" selected disabled>Select Type</option>
              <option value="Pure Veg">Pure Veg</option>
              <option value="Non-Veg">Non-Veg</option>
            </select>
          </div>

          <!-- Checkbox Fields -->
          <div class="form-group">
            <label>Ingredients</label>
            <br>
            {% for ingredient in ingredients %}
            <label for="checkbox1"></label><input type="checkbox" id="checkbox1" name="ingredients"
              value="{{ ingredient }}"> {{ ingredient }}</label>

            {% endfor %}
          </div>

          <!-- Textarea Field -->
          <div class="form-group">
            <label for="textareaField">Description:</label>
            <textarea class="form-control" id="description" placeholder="Description" name="description"
              rows="3"></textarea>
          </div>

          <!-- File Field -->
          <div class="form-group">
            <label for="fileField">Image</label>
            <input type="file" class="form-control py-2 rounded-0" id="images" name="images" placeholder="Image"
              accept=".png,.jpg,.jpeg,.webp">
          </div>

        </div>
        <div class="modal-footer">
          <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
          <button type="submit" class="btn btn-primary">Save changes</button>
        </div>
      </form>
    </div>
  </div>
</div>

<style>
  .description-container .full-description {
    display: none;
  }

  .description-container.show-full-description .full-description {
    display: block;
  }
</style>

<script>
  // Add JavaScript to toggle visibility
  document.addEventListener("DOMContentLoaded", function () {
    var toggleButtons = document.querySelectorAll('.toggle-description');

    toggleButtons.forEach(function (button) {
      button.addEventListener('click', function (event) {
        event.preventDefault();
        var descriptionContainer = this.closest('.description-container');
        var fullDescription = descriptionContainer.querySelector('.full-description');
        descriptionContainer.classList.toggle('show-full-description');
        button.textContent = descriptionContainer.classList.contains('show-full-description') ? 'Read Less' : 'Read More';
      });
    });
  });
</script>
{% endblock content %}